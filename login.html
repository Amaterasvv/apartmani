<!doctype html>
<html lang="hr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Prijava / Registracija | Adria Apartmani</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link href="styles.css" rel="stylesheet">
</head>
<body class="auth-body">

<!-- NAV (identičan ostalim stranicama) -->
<nav class="navbar navbar-expand-lg navbar-light bg-white sticky-top shadow-sm">
  <div class="container">
    <a class="navbar-brand fw-bold" href="index.html">Adria Apartmani</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="nav">
      <ul class="navbar-nav ms-auto align-items-lg-center">
        <li class="nav-item"><a class="nav-link" href="apartmani.html">Apartmani</a></li>
        <li class="nav-item"><a class="nav-link" href="o-nama.html">O nama</a></li>
        <li class="nav-item"><a class="nav-link" href="kontakt.html">Kontakt</a></li>

        <!-- slot koji puni script.js (jedna ikona + "Prijava" ili avatar ako je user logiran) -->
        <li class="nav-item ms-lg-2 js-auth-slot"></li>

        <li class="nav-item ms-lg-2">
          <a class="btn btn-dark position-relative" href="checkout.html">
            Rezervacije
            <span id="cart-badge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0</span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<main class="auth-wrap">
  <div class="auth-card card border-0 shadow-lg">
    <div class="card-body p-4 p-md-5">

      <!-- Tabs -->
      <ul class="nav nav-pills justify-content-center gap-2 mb-4" id="authTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="tab-login" data-bs-toggle="pill" data-bs-target="#pane-login" type="button" role="tab">
            Prijava
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab-register" data-bs-toggle="pill" data-bs-target="#pane-register" type="button" role="tab">
            Registracija
          </button>
        </li>
      </ul>

      <div class="tab-content">

        <!-- LOGIN -->
        <div class="tab-pane fade show active" id="pane-login" role="tabpanel">
          <h1 class="auth-title">Dobrodošli natrag 👋</h1>
          <p class="text-secondary mb-4">Prijavite se u svoj račun kako biste dovršili rezervaciju.</p>

          <div id="login-error" class="alert alert-danger d-none mb-3">
            Pogrešan email ili lozinka.
          </div>

          <form class="vstack gap-3" onsubmit="handleLogin(event)" id="login-form" novalidate>
            <div class="form-floating with-icon">
              <input type="email" class="form-control" id="l-email" placeholder="Email adresa" required>
              <label for="l-email">Email adresa</label>
              <i class="bi bi-envelope icon"></i>
              <div class="invalid-feedback">Unesite ispravan email.</div>
            </div>

            <div class="form-floating with-icon">
              <input type="password" class="form-control" id="l-pass" placeholder="Lozinka" required minlength="6">
              <label for="l-pass">Lozinka</label>
              <i class="bi bi-key icon"></i>
              <button type="button" class="btn-eye" data-target="#l-pass"><i class="bi bi-eye"></i></button>
              <div class="invalid-feedback">Najmanje 6 znakova.</div>
            </div>

            <div class="d-flex justify-content-between align-items-center">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="remember">
                <label class="form-check-label" for="remember">Zapamti me</label>
              </div>
              <a class="small text-decoration-none" href="#">Zaboravili ste lozinku?</a>
            </div>

            <button id="login-submit" class="btn btn-dark btn-lg w-100" disabled>Prijava</button>

            <div class="auth-divider"><span>ili</span></div>

            <button type="button" class="btn btn-facebook w-100">
              <i class="bi bi-facebook me-2"></i> Nastavite putem Facebook-a
            </button>
            <button type="button" class="btn btn-google w-100">
              <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" width="18" class="me-2" alt="">
              Nastavite putem Google-a
            </button>

            <p class="text-center small mt-2 mb-0">Nemate račun? <a href="#pane-register" data-bs-toggle="pill">Registracija</a></p>

            <div class="text-secondary small mt-2">Admin primjer: <code>admin@adria.local</code> / <code>admin123</code></div>
          </form>
        </div>

        <!-- REGISTER -->
        <div class="tab-pane fade" id="pane-register" role="tabpanel">
          <h1 class="auth-title">Kreiraj račun ✨</h1>
          <p class="text-secondary mb-4">Brza registracija za brže rezervacije.</p>

          <div id="reg-error" class="alert alert-danger d-none mb-3">
            Korisnik s tim emailom već postoji.
          </div>

          <form class="vstack gap-3" onsubmit="handleRegister(event)" id="reg-form" novalidate>
            <div class="row g-3">
              <div class="col-md-6">
                <div class="form-floating">
                  <input class="form-control" id="r-first" name="first" placeholder="Ime" required>
                  <label for="r-first">Ime</label>
                  <div class="invalid-feedback">Obavezno polje.</div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-floating">
                  <input class="form-control" id="r-last" name="last" placeholder="Prezime" required>
                  <label for="r-last">Prezime</label>
                  <div class="invalid-feedback">Obavezno polje.</div>
                </div>
              </div>
            </div>

            <div class="form-floating with-icon">
              <input type="email" class="form-control" id="r-email" placeholder="Email" required>
              <label for="r-email">Email</label>
              <i class="bi bi-envelope icon"></i>
              <div class="invalid-feedback">Unesite ispravan email.</div>
            </div>

            <div class="form-floating with-icon">
              <input type="password" class="form-control" id="r-pass" placeholder="Lozinka" required minlength="6">
              <label for="r-pass">Lozinka</label>
              <i class="bi bi-key icon"></i>
              <button type="button" class="btn-eye" data-target="#r-pass"><i class="bi bi-eye"></i></button>
              <div class="invalid-feedback">Najmanje 6 znakova.</div>
            </div>

            <button id="reg-submit" class="btn btn-dark btn-lg w-100" disabled>Kreiraj račun</button>

            <p class="text-center small mt-2 mb-0">Već imate račun? <a href="#pane-login" data-bs-toggle="pill">Prijava</a></p>
          </form>
        </div>

      </div>
    </div>
  </div>
</main>

<footer class="footer mt-5">
  <div class="container py-5">
    <div class="row g-4">
      <!-- Brand + opis -->
      <div class="col-md-5">
        <a class="footer-brand d-inline-flex align-items-center text-decoration-none mb-2" href="index.html">
          <i class="bi bi-house-door-fill me-2"></i>
          <span class="fw-bold">Adria Apartmani</span>
        </a>
        <p class="text-white-50 mb-2 small">
          Smještaj uz more — Zadar • Split • Dubrovnik • Rovinj • Pula • Šibenik • Hvar
        </p>
        <div class="d-flex gap-2 footer-social">
          <a class="btn btn-outline-light btn-sm" href="#" aria-label="Instagram"><i class="bi bi-instagram"></i></a>
          <a class="btn btn-outline-light btn-sm" href="#" aria-label="Facebook"><i class="bi bi-facebook"></i></a>
          <a class="btn btn-outline-light btn-sm" href="mailto:info@example.com" aria-label="Email"><i class="bi bi-envelope"></i></a>
        </div>
      </div>

      <!-- Navigacija -->
      <div class="col-6 col-md-3">
        <h6 class="text-uppercase small text-white-50">Navigacija</h6>
        <ul class="list-unstyled">
          <li><a class="footer-link" href="apartmani.html">Apartmani</a></li>
          <li><a class="footer-link" href="o-nama.html">O nama</a></li>
          <li><a class="footer-link" href="kontakt.html">Kontakt</a></li>
        </ul>
      </div>

      <!-- Pravno + lokacija -->
      <div class="col-6 col-md-4">
        <h6 class="text-uppercase small text-white-50">Pravno</h6>
        <ul class="list-unstyled">
          <li><a class="footer-link" href="uvjeti.html">Uvjeti korištenja</a></li>
          <li><a class="footer-link" href="politika-privatnosti.html">Privatnost</a></li>
        </ul>
        <div class="small text-white-50 mt-2">
          <i class="bi bi-geo-alt"></i> Hrvatska obala
        </div>
      </div>
    </div>

    <hr class="border-secondary-subtle my-4">

    <div class="d-flex flex-column flex-md-row justify-content-between align-items-center small text-white-50">
      <div>© <span id="year"></span> Adria Apartmani</div>
      <div>
        Izrada:
        <a class="footer-link fw-semibold" href="kodeblack.hr" target="_blank" rel="noopener">
          Kode Black
        </a>
        <i class="bi bi-box-arrow-up-right"></i>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="script.js"></script>
<script>
  // inic – admin + header avatar/badge
  document.addEventListener('DOMContentLoaded', () => {
    window.seedAdmin?.();
    window.renderAuthNav?.();
    window.updateBadge?.();
  });

  // oko za lozinku
  document.addEventListener('click', (e)=>{
    const btn = e.target.closest('.btn-eye'); if(!btn) return;
    const input = document.querySelector(btn.dataset.target);
    if(!input) return;
    input.type = input.type === 'password' ? 'text' : 'password';
    btn.querySelector('i').classList.toggle('bi-eye');
    btn.querySelector('i').classList.toggle('bi-eye-slash');
  });

  // enable/disable submit po validnosti
  function wireValidity(formId, submitId){
    const form = document.getElementById(formId);
    const btn  = document.getElementById(submitId);
    if(!form || !btn) return;
    const check = () => {
      btn.disabled = !form.checkValidity();
      form.classList.add('was-validated');
    };
    form.addEventListener('input', check);
    form.addEventListener('change', check);
    check();
  }
  wireValidity('login-form','login-submit');
  wireValidity('reg-form','reg-submit');

  // hash -> odgovarajući tab
  if (location.hash === '#register') {
    const t = document.querySelector('[data-bs-target="#pane-register"]');
    t && new bootstrap.Tab(t).show();
  } else if (location.hash === '#login') {
    const t = document.querySelector('[data-bs-target="#pane-login"]');
    t && new bootstrap.Tab(t).show();
  }
</script>
</body>
</html>
